---
import { type CollectionEntry, getCollection } from 'astro:content'
import { Image } from 'astro:assets'
import BaseLayout from '@layouts/BaseLayout.astro'
import { timeago } from '../../support/time'
import { SITE } from '../../config'


export async function getStaticPaths() {
    const posts = await getCollection('posts')
    return posts.map(post => ({
        params: { slug: post.slug },
        props: post,
    }))
}
type Props = CollectionEntry<'posts'>

const post = Astro.props
const { Content, remarkPluginFrontmatter } = await post.render()

// import marked from 'marked';
// const text =  marked.parse(post.body||'')
// console.log(marked.parse(post.body||''));



const category: CollectionEntry<'categories'> = (await getCollection('categories')).filter(
    c => c.slug === post.data.category,
).pop()


const tags = post.data.tags ?? [category.slug]
const URL = Astro.url.href
const ogImage = undefined; // todo

// console.log(post.data.cardImage);
---

<BaseLayout
    title={post.data.title}
    description={post.data.description}
    ogImage={ogImage}
    structuredData={{
        '@context': 'https://schema.org',
        '@type': 'NewsArticle',
        '@id': URL,
        'url': URL,
        'description': post.data.description,
        'image': [
            // post.data.cardImage,
        ],
        'headline': post.data.title,
        'datePublished': post.data.pubDate,
        'dateModified': post.data.pubDate,
        'author': [{
            '@type': 'Person',
            'name': SITE.author,
            'url': SITE.url,
        }],
    }}
>
    <section class="mx-auto max-w-6xl px-4 pb-12 pt-8 sm:px-6 lg:px-8 lg:pt-12">
        <div class="shadow-none sm:shadow-sm mt-4 sm:mt-0">
            <div class="max-w-6xl">
                <Image title={post.data.title}
                    class="w-full object-cover rounded-tl-sm rounded-tr-sm"
                    src={post.data.cardImage}
                    alt={post.data.title}
                    draggable="false"
                    format="avif"
                />
            </div>
            <div class="sm:dark:bg-neutral-900/30 sm:bg-neutral-100 px-0 sm:px-6 md:px-10 lg:px-14 py-6">
                <div class="mb-10">
                    <h2 class="block text-balance text-3xl font-bold tracking-tight text-neutral-800 dark:text-neutral-300 md:text-4xl lg:text-5xl">
                        {post.data.title}
                    </h2>
                    <ol class="flex items-center whitespace-nowrap mt-2">
                        <li class="inline-flex items-center">
                            <a
                                class="flex items-center text-sm text-orange-400 hover:text-orange-500 focus:outline-none focus:text-orange-500"
                                href=`/categories/${category.slug}`
                            >
                            ðŸ”–{category?.data?.title}
                            </a>
                            <svg
                                class="flex-shrink-0 size-5 text-neutral-500 dark:text-neutral-600 mx-2"
                                width="16"
                                height="16"
                                viewBox="0 0 16 16"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                                aria-hidden="true"
                            >
                                <path d="M6 13L10 3" stroke="currentColor" stroke-linecap="round"></path>
                            </svg>
                        </li>
                        <li class="inline-flex items-center text-sm text-neutral-500 hover:text-neutral-600 focus:outline-none focus:text-neutral-600 dark:text-neutral-500 dark:hover:text-neutral-400 dark:focus:text-neutral-400">
                            {timeago(post.data.pubDate)}
                            <svg
                                class="flex-shrink-0 size-5 text-neutral-500 dark:text-neutral-600 mx-2"
                                width="16"
                                height="16"
                                viewBox="0 0 16 16"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                                aria-hidden="true"
                            >
                                <path d="M6 13L10 3" stroke="currentColor" stroke-linecap="round"></path>
                            </svg>
                        </li>
                        <li title="é˜…è¯»æ—¶é—´"
                            class="inline-flex items-center text-sm text-neutral-500 hover:text-neutral-600 focus:outline-none focus:text-neutral-600 dark:text-neutral-500 dark:hover:text-neutral-400 dark:focus:text-neutral-400"
                            aria-current="page"
                        >
                        <svg class="w-4 h-4" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12148" width="32" height="32"><path d="M210.1248 122.7264c56.6272-8.4992 114.176-21.5552 171.52-11.9296 38.2464 6.144 72.96 24.4224 105.1648 45.1072 39.2192-26.5728 84.7872-44.3904 132.3008-47.2064 57.088-5.1712 112.9472 10.24 169.5744 14.1824 44.1856 3.6352 88.4224 7.8336 132.864 7.2704 12.3392 0.1024 24.9344-0.6144 37.1712 1.7408 11.8272 2.56 20.0192 14.4384 19.3024 26.368 0.7168 49.2032-0.1536 98.4064 0.3072 147.6096 21.4016 26.7264 38.1952 57.5488 45.6704 91.1872v92.8768c-7.2192 33.6384-23.808 64.6656-45.4656 91.2384-0.8704 84.6336 0.2048 169.3184-0.512 253.952 1.4848 16.7936-14.7456 29.2864-30.6176 27.8016-114.944 0.2048-229.9392 0.1536-344.8832 0-2.048 9.216-1.792 20.5312-10.3936 26.624-9.3184 7.9872-22.528 6.0928-33.8944 6.656-53.0432-0.8704-106.0864 0.6656-159.0784-0.6656-17.4592 0.256-26.112-17.152-26.3168-32.4608-112.3328-0.2048-224.768 0.2048-337.1008-0.1536-15.7696 1.4336-31.7952-11.008-30.4128-27.648-0.3072-225.6896-0.3584-451.4304 0-677.0688-1.4336-16.7424 14.7968-29.2352 30.5664-27.648 58.1632 0.6144 116.4288-1.1776 174.2336-7.8336M134.0928 184.064c0 202.24-0.0512 404.5312 0 606.7712 63.2832-24.4224 125.6448-54.8352 193.536-63.7952 50.8416-7.2192 101.7856 12.3392 139.9808 45.4144-0.1536-188.0576-0.1024-376.1152-0.0512-564.224-32.512-23.0912-68.8128-44.032-109.6192-46.6944-75.6224-5.3248-148.4288 23.1424-223.8464 22.528m374.5792 22.6816c-7.0656 3.6352-4.096 12.1344-4.864 18.3808 0.3584 182.9888 0.1536 366.0288 0.1024 549.0688 20.3776-18.1248 43.3664-34.048 69.7344-41.984 39.3216-12.1856 81.5104-6.912 120.576 3.6352 52.1728 14.2848 102.2976 34.7136 152.4736 54.6816 0.0512-44.8512 0.0512-89.7024 0-134.5536-67.2768 12.4416-139.8784-6.7584-191.0784-52.48-49.152-42.5472-77.3632-108.2368-72.6016-173.2608 3.5328-63.7952 38.7584-124.1088 90.8288-160.6656 49.408-35.4816 113.2032-48.7936 172.9024-38.0928-0.0512-16.5376 0-33.0752 0-49.6128-41.6768-3.6352-83.456-6.656-124.8256-13.1584-38.912-6.2464-78.848-11.3664-118.0672-4.7104-34.8672 5.5296-67.2256 21.7088-95.1808 42.752m-448.4608-23.04c-0.1024 208.64-0.1024 417.2288 0 625.8688h36.096c0.0512-208.64 0.0512-417.2288 0-625.8688h-36.096m822.6304 0.1024c0.0512 19.3024-0.4096 38.656 0.512 57.9072 13.7216 5.2224 26.9312 11.52 39.8848 18.3808-0.0512-25.4464 0.0512-50.8928-0.1024-76.3904-13.4144-0.0512-26.8288 0-40.2944 0.1024m-107.0592 96.256c-42.5984 7.0656-82.2784 30.5664-108.4416 64.9728-47.4112 59.6992-43.52 152.4224 8.704 207.9232 55.3984 63.488 158.2592 75.3152 227.2768 27.4432 62.8736-39.8848 91.5968-125.3376 63.3856-194.6624-27.648-75.1104-112.9984-120.4224-190.9248-105.6768m107.0592 366.4384c0.0512 54.3232 0 108.6464 0.0512 162.9696 13.4144 0.1024 26.8288 0.1536 40.2432 0.1024 0.1536-60.672 0-121.3952 0.1024-182.0672-13.2608 6.7584-26.6752 13.2096-40.3968 18.9952M183.2448 809.1648c90.88 0.8704 181.8112 0.4096 272.7424 0.256-30.8736-30.6176-72.9088-53.1968-117.5552-48.6912-54.3744 5.376-105.0624 28.16-155.1872 48.4352m335.0528 0.256c93.1328 0.1024 186.3168 0.7168 279.4496-0.3072-52.6848-20.9408-106.24-43.2128-163.1232-49.1008-44.4416-4.9152-87.04 17.1008-116.3264 49.408z" fill="#20335D" p-id="12149"></path><path d="M324.352 236.7488c8.4992-11.008 28.0576-7.0656 31.6416 6.3488 3.7888 10.24-5.2224 18.4832-10.9056 25.7536-36.9664 43.1104-73.0624 87.04-110.1312 130.048-7.1168 10.0864-22.6304 9.3184-30.0544-0.0512-17.7152-17.7152-35.9936-34.9696-52.992-53.3504-11.9296-13.4656 5.9904-34.4064 21.6576-27.0848 16.5376 11.6736 29.5936 27.648 43.4688 42.2912 11.9296-8.6016 19.8144-21.3504 29.5424-32.1536 26.112-30.464 51.3536-61.6448 77.7728-91.8016zM788.992 307.3024c4.2496-15.9744 30.72-15.2576 33.3824 1.28 1.792 29.7984 0.0512 59.7504 0.7168 89.6 13.1072 5.888 23.808 15.4112 30.3104 28.2624 20.3264 0.8704 40.8064-1.4848 60.9792 1.2288 14.4384 4.1984 14.848 26.88 0.4608 31.4368-20.6336 3.328-41.6768 0.1024-62.4128 1.9968-7.9872 16.6912-24.3712 29.4912-43.3152 29.7984-27.5968 2.3552-54.1696-22.8864-51.1488-50.8928 0.5632-18.6368 14.5408-32.8704 30.0544-41.2672 0.8704-30.464-1.1264-61.0304 0.9728-91.4432zM324.7104 386.0992c9.216-11.3152 29.9008-5.4784 31.7952 9.0112 1.9968 9.0112-5.5296 15.8208-10.3936 22.3232-36.9664 43.2128-73.2672 87.04-110.1824 130.304-7.168 10.9056-23.6544 10.6496-31.4368 0.5632-17.7152-18.2784-36.8128-35.2768-53.6064-54.3232-10.5984-14.9504 10.1888-34.304 24.9344-24.576 15.6672 12.4928 28.4672 28.16 43.264 41.6256 35.328-41.5232 69.9392-83.712 105.6256-124.928zM320.4096 540.5184c5.2736-6.8096 13.7728-13.3632 22.8864-9.8816 13.312 2.6624 18.2272 21.2992 7.8336 30.208-38.0416 45.568-76.4928 90.88-114.7904 136.2432-6.5024 9.8304-21.6576 11.9808-29.696 2.8672-18.2784-17.7664-36.5568-35.6352-54.0672-54.0672-13.1072-13.3632 5.2224-35.7376 21.4016-27.8016 16.8448 12.1856 29.6448 28.928 45.056 42.7008 33.8432-40.0384 67.6352-80.128 101.376-120.2688z" fill="#20335D" p-id="12150"></path><path d="M134.0928 184.064c75.4176 0.6144 148.224-27.8528 223.8464-22.528 40.8064 2.6624 77.1072 23.6032 109.6192 46.6944-0.0512 188.1088-0.1024 376.1664 0.0512 564.224-38.1952-33.0752-89.1392-52.6336-139.9808-45.4144-67.8912 8.96-130.2528 39.3728-193.536 63.7952-0.0512-202.24 0-404.5312 0-606.7712m190.2592 52.6848c-26.4192 30.1568-51.6608 61.3376-77.7728 91.8016-9.728 10.8032-17.6128 23.552-29.5424 32.1536-13.8752-14.6432-26.9312-30.6176-43.4688-42.2912-15.6672-7.3216-33.5872 13.6192-21.6576 27.0848 16.9984 18.3808 35.2768 35.6352 52.992 53.3504 7.424 9.3696 22.9376 10.1376 30.0544 0.0512 37.0688-43.008 73.1648-86.9376 110.1312-130.048 5.6832-7.2704 14.6944-15.5136 10.9056-25.7536-3.584-13.4144-23.1424-17.3568-31.6416-6.3488m0.3584 149.3504c-35.6864 41.216-70.2976 83.4048-105.6256 124.928-14.7968-13.4656-27.5968-29.1328-43.264-41.6256-14.7456-9.728-35.5328 9.6256-24.9344 24.576 16.7936 19.0464 35.8912 36.0448 53.6064 54.3232 7.7824 10.0864 24.2688 10.3424 31.4368-0.5632 36.9152-43.264 73.216-87.0912 110.1824-130.304 4.864-6.5024 12.3904-13.312 10.3936-22.3232-1.8944-14.4896-22.5792-20.3264-31.7952-9.0112m-4.3008 154.4192c-33.7408 40.1408-67.5328 80.2304-101.376 120.2688-15.4112-13.7728-28.2112-30.5152-45.056-42.7008-16.1792-7.936-34.5088 14.4384-21.4016 27.8016 17.5104 18.432 35.7888 36.3008 54.0672 54.0672 8.0384 9.1136 23.1936 6.9632 29.696-2.8672 38.2976-45.3632 76.7488-90.6752 114.7904-136.2432 10.3936-8.9088 5.4784-27.5456-7.8336-30.208-9.1136-3.4816-17.6128 3.072-22.8864 9.8816zM508.672 206.7456c27.9552-21.0432 60.3136-37.2224 95.1808-42.752 39.2192-6.656 79.1552-1.536 118.0672 4.7104 41.3696 6.5024 83.1488 9.5232 124.8256 13.1584 0 16.5376-0.0512 33.0752 0 49.6128-59.6992-10.7008-123.4944 2.6112-172.9024 38.0928-52.0704 36.5568-87.296 96.8704-90.8288 160.6656-4.7616 65.024 23.4496 130.7136 72.6016 173.2608 51.2 45.7216 123.8016 64.9216 191.0784 52.48 0.0512 44.8512 0.0512 89.7024 0 134.5536-50.176-19.968-100.3008-40.3968-152.4736-54.6816-39.0656-10.5472-81.2544-15.8208-120.576-3.6352-26.368 7.936-49.3568 23.8592-69.7344 41.984 0.0512-183.04 0.256-366.08-0.1024-549.0688 0.768-6.2464-2.2016-14.7456 4.864-18.3808z" fill="#FFFFFF" p-id="12151"></path><path d="M775.7824 280.064c77.9264-14.7456 163.2768 30.5664 190.9248 105.6768 28.2112 69.3248-0.512 154.7776-63.3856 194.6624-69.0176 47.872-171.8784 36.0448-227.2768-27.4432-52.224-55.5008-56.1152-148.224-8.704-207.9232 26.1632-34.4064 65.8432-57.9072 108.4416-64.9728m13.2096 27.2384c-2.0992 30.4128-0.1024 60.9792-0.9728 91.4432-15.5136 8.3968-29.4912 22.6304-30.0544 41.2672-3.0208 28.0064 23.552 53.248 51.1488 50.8928 18.944-0.3072 35.328-13.1072 43.3152-29.7984 20.736-1.8944 41.7792 1.3312 62.4128-1.9968 14.3872-4.5568 13.9776-27.2384-0.4608-31.4368-20.1728-2.7136-40.6528-0.3584-60.9792-1.2288-6.5024-12.8512-17.2032-22.3744-30.3104-28.2624-0.6656-29.8496 1.0752-59.8016-0.7168-89.6-2.6624-16.5376-29.1328-17.2544-33.3824-1.28z" fill="#FFFFFF" p-id="12152"></path><path d="M60.2112 183.7056h36.096c0.0512 208.64 0.0512 417.2288 0 625.8688h-36.096c-0.1024-208.64-0.1024-417.2288 0-625.8688zM882.8416 183.808c13.4656-0.1024 26.88-0.1536 40.2944-0.1024 0.1536 25.4976 0.0512 50.944 0.1024 76.3904-12.9536-6.8608-26.1632-13.1584-39.8848-18.3808-0.9216-19.2512-0.4608-38.6048-0.512-57.9072zM882.8416 646.5024c13.7216-5.7856 27.136-12.2368 40.3968-18.9952-0.1024 60.672 0.0512 121.3952-0.1024 182.0672-13.4144 0.0512-26.8288 0-40.2432-0.1024-0.0512-54.3232 0-108.6464-0.0512-162.9696zM183.2448 809.1648c50.1248-20.2752 100.8128-43.0592 155.1872-48.4352 44.6464-4.5056 86.6816 18.0736 117.5552 48.6912-90.9312 0.1536-181.8624 0.6144-272.7424-0.256zM518.2976 809.4208c29.2864-32.3072 71.8848-54.3232 116.3264-49.408 56.8832 5.888 110.4384 28.16 163.1232 49.1008-93.1328 1.024-186.3168 0.4096-279.4496 0.3072z" fill="#1CC9B5" p-id="12153"></path></svg>    
                        
                        {remarkPluginFrontmatter.minutesRead}
                        </li>
                    </ol>
                </div>

                <article class="prose prose-blog sm:prose-lg dark:prose-invert max-w-none">
                    <Content />
                </article>

                <div class="mt-10 md:mt-14 mx-auto grid max-w-screen-lg gap-y-5 sm:flex sm:items-center sm:justify-between sm:gap-y-0">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 sm:flex-nowrap sm:items-center sm:gap-y-0">
                        ðŸ”–{
                            tags.map((tag: string) => (
                                <span class="inline-flex items-center gap-x-1.5 rounded-lg bg-neutral-400/30 px-3 py-1.5 text-xs font-medium text-neutral-700 outline-none focus:outline-none focus-visible:outline-none focus-visible:ring dark:bg-neutral-700/60 dark:text-neutral-300">
                                    {tag}
                                </span>
                            ))
                        }
                    </div>
                    <!--<div class="flex items-center justify-end gap-x-1.5">-->
                    <!--    <Bookmark />-->
                    <!--    <div class="mx-3 block h-4 border-e border-neutral-400 dark:border-neutral-500"></div>-->
                    <!--    <div class="inline-flex">-->
                    <!--        <SocialShare pageTitle={post.data.title} />-->
                    <!--    </div>-->
                    <!--</div>-->
                </div>
            </div>
        </div>
    </section>

    <!-- <script define:vars={{text}}>
        console.log(text);
        
        let utterThis = new SpeechSynthesisUtterance();
        utterThis.text = text
        utterThis.lang = 'zh-CN';// æ±‰è¯­ zh-CN è‹±æ–‡ en-US
        utterThis.rate = 1;//è¯­é€Ÿ
        // speechSynthesis.speak(utterThis);
    </script> -->


</BaseLayout>


